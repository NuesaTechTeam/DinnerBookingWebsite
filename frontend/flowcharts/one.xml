<mxfile host="app.diagrams.net" modified="2024-01-01T00:00:00.000Z" agent="Claude" version="22.0.0" etag="xxx">
  <diagram name="System Operation Flow" id="operation-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- START -->
        <mxCell id="start" value="START" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="325" y="20" width="120" height="50" as="geometry" />
        </mxCell>
        
        <!-- Initialize Systems -->
        <mxCell id="init" value="Initialize Systems:&#xa;• ESP32 modules&#xa;• MPU-6050 IMU&#xa;• Bluetooth connection&#xa;• Ultrasonic sensors&#xa;• Motor drivers" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="275" y="100" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="start-to-init" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="start" target="init">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Read IMU Sensor Data -->
        <mxCell id="read-imu" value="Read IMU Sensor Data&#xa;(Accelerometer +&#xa;Gyroscope)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="275" y="230" width="220" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="init-to-imu" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="init" target="read-imu">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Apply Sensor Fusion -->
        <mxCell id="sensor-fusion" value="Apply Sensor Fusion&#xa;(Complementary Filter)&#xa;Calculate: Pitch, Roll" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="275" y="330" width="220" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="imu-to-fusion" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="read-imu" target="sensor-fusion">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Classify Gesture -->
        <mxCell id="classify" value="Classify Gesture:&#xa;• Forward&#xa;• Backward&#xa;• Turn Left&#xa;• Turn Right&#xa;• Stop" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;" vertex="1" parent="1">
          <mxGeometry x="275" y="430" width="220" height="90" as="geometry" />
        </mxCell>
        
        <mxCell id="fusion-to-classify" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="sensor-fusion" target="classify">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Transmit via Bluetooth -->
        <mxCell id="transmit" value="Transmit via Bluetooth&#xa;to Wheelchair ESP32" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="275" y="550" width="220" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="classify-to-transmit" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="classify" target="transmit">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Receive Gesture Command -->
        <mxCell id="receive" value="Receive Gesture&#xa;Command on Wheelchair" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="275" y="640" width="220" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="transmit-to-receive" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="transmit" target="receive">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Read Ultrasonic Sensors -->
        <mxCell id="ultrasonic" value="Read Ultrasonic&#xa;Sensors (4 units)&#xa;Check for Obstacles" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="275" y="730" width="220" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="receive-to-ultra" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="receive" target="ultrasonic">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Obstacle Decision -->
        <mxCell id="obstacle-check" value="Obstacle?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="305" y="830" width="160" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="ultra-to-obstacle" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="ultrasonic" target="obstacle-check">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Critical Distance Check -->
        <mxCell id="critical-check" value="Critical&#xa;Distance?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="80" y="950" width="140" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="obstacle-yes" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="obstacle-check" target="critical-check">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Execute Gesture Command -->
        <mxCell id="execute" value="Execute Gesture&#xa;Command:&#xa;• Set motor direction&#xa;• Set PWM speed&#xa;• Smooth ramp" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;" vertex="1" parent="1">
          <mxGeometry x="485" y="950" width="180" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="obstacle-no" value="NO" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="obstacle-check" target="execute">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- STOP Motors -->
        <mxCell id="stop-motors" value="STOP&#xa;Motors&#xa;Alert" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="1080" width="100" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="critical-yes" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="critical-check" target="stop-motors">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Reduce Speed -->
        <mxCell id="reduce-speed" value="Reduce&#xa;Speed&#xa;50%" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="160" y="1080" width="100" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="critical-no" value="NO" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="critical-check" target="reduce-speed">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Check Emergency Stop -->
        <mxCell id="emergency-check-box" value="Check Emergency&#xa;Stop Button" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="275" y="1200" width="220" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="stop-to-emergency" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="stop-motors" target="emergency-check-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="reduce-to-emergency" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="reduce-speed" target="emergency-check-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="execute-to-emergency" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="execute" target="emergency-check-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Emergency Stop Decision -->
        <mxCell id="emergency-decision" value="Pressed?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="305" y="1290" width="160" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="check-to-decision" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="emergency-check-box" target="emergency-decision">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Emergency Stop Action -->
        <mxCell id="emergency-stop" value="EMERGENCY&#xa;STOP ALL&#xa;Require Reset" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontColor=#CC0000;" vertex="1" parent="1">
          <mxGeometry x="80" y="1400" width="140" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="emergency-yes" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="emergency-decision" target="emergency-stop">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Update Status -->
        <mxCell id="update-status" value="Update Status&#xa;LEDs &amp; Buzzer" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="295" y="1520" width="180" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="emergency-no" value="NO" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="emergency-decision" target="update-status">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Loop Back -->
        <mxCell id="loop-back" value="[LOOP BACK]" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="310" y="1610" width="150" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="status-to-loop" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="update-status" target="loop-back">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Loop back connection -->
        <mxCell id="loop-connection" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#666666;dashed=1;" edge="1" parent="1" source="loop-back" target="read-imu">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="720" y="1635" />
              <mxPoint x="720" y="265" />
            </Array>
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>